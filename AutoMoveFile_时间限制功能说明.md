# 自动移动文件 - 时间限制功能说明

## 功能概述

在现有的自动移动文件功能基础上，新增了时间限制功能。该功能可以根据文件的最后修改时间来决定是否执行移动操作。

## 新增配置参数

### MoveTimeLimitMinutes

- **类型**：整数（int）
- **单位**：分钟
- **默认值**：0
- **说明**：设置移动时间限制。如果文件的最后修改时间与当前时间的差值小于等于此限制值，则该文件将跳过移动操作。

### 配置说明

- `MoveTimeLimitMinutes=0`：不启用时间限制，所有文件都会被移动（保持原有行为）
- `MoveTimeLimitMinutes=30`：30分钟内修改的文件不会被移动
- `MoveTimeLimitMinutes=60`：1小时内修改的文件不会被移动

## 功能特点

1. **向后兼容**：默认值为0，不影响现有功能
2. **精确控制**：支持分钟级别的时间控制
3. **详细日志**：被跳过的文件会记录详细的跳过原因
4. **独立配置**：每个移动任务可以设置不同的时间限制

## 使用场景

- **防止移动正在使用的文件**：设置较短的时间限制（如5-10分钟）
- **只移动旧文件**：设置较长的时间限制（如60分钟或更长）
- **分批处理**：根据业务需要设置合适的时间间隔

## 配置示例

```ini
[MoveTask]
SourceDirectory=D:\TempFiles
TargetDirectory=E:\Archive
# 30分钟内修改的文件不会被移动
MoveTimeLimitMinutes=30

[MoveTask] 
SourceDirectory=C:\LogFiles
TargetDirectory=D:\LogArchive
# 不启用时间限制，所有文件都会被移动
MoveTimeLimitMinutes=0
```

## 日志输出

系统会记录以下信息：
- 移动成功的文件数量
- 跳过移动的文件数量及原因
- 每个被跳过文件的详细时间信息

## 注意事项

1. 时间计算基于文件的 `LastWriteTime` 属性
2. 时间比较使用当前系统时间
3. 如果读取文件时间出现异常，该文件仍会执行移动操作
4. 配置文件中的参数不区分大小写
